package project.safenfctaskapp.mcoupon;

import java.security.KeyPair;
import java.security.KeyPairGenerator;
import java.security.NoSuchAlgorithmException;
import java.security.SecureRandom;
import java.util.ArrayList;
import java.util.UUID;

public class Certificate {
	private boolean tempMode = true;
	
	public static ArrayList<CertificateIDPair> ciArray = new ArrayList<CertificateIDPair>();
	
	public Certificate()
	{
		if(tempMode && ciArray.size() == 0)		//임시모드 CA가 있다고 가정하고 키를 받아온다.
		{
			//CA
			CertificateIDPair ci = new CertificateIDPair();
			ci.ID = "CA";
			byte[] CAKeyByte = {-84, -19, 0, 5, 115, 114, 0, 21, 106, 97, 118, 97, 46, 115, 101, 99, 117, 114, 105, 116, 121, 46, 75, 101, 121, 80, 97, 105, 114, -105, 3, 12, 58, -46, -51, 18, -109, 2, 0, 2, 76, 0, 10, 112, 114, 105, 118, 97, 116, 101, 75, 101, 121, 116, 0, 26, 76, 106, 97, 118, 97, 47, 115, 101, 99, 117, 114, 105, 116, 121, 47, 80, 114, 105, 118, 97, 116, 101, 75, 101, 121, 59, 76, 0, 9, 112, 117, 98, 108, 105, 99, 75, 101, 121, 116, 0, 25, 76, 106, 97, 118, 97, 47, 115, 101, 99, 117, 114, 105, 116, 121, 47, 80, 117, 98, 108, 105, 99, 75, 101, 121, 59, 120, 112, 115, 114, 0, 20, 106, 97, 118, 97, 46, 115, 101, 99, 117, 114, 105, 116, 121, 46, 75, 101, 121, 82, 101, 112, -67, -7, 79, -77, -120, -102, -91, 67, 2, 0, 4, 76, 0, 9, 97, 108, 103, 111, 114, 105, 116, 104, 109, 116, 0, 18, 76, 106, 97, 118, 97, 47, 108, 97, 110, 103, 47, 83, 116, 114, 105, 110, 103, 59, 91, 0, 7, 101, 110, 99, 111, 100, 101, 100, 116, 0, 2, 91, 66, 76, 0, 6, 102, 111, 114, 109, 97, 116, 113, 0, 126, 0, 5, 76, 0, 4, 116, 121, 112, 101, 116, 0, 27, 76, 106, 97, 118, 97, 47, 115, 101, 99, 117, 114, 105, 116, 121, 47, 75, 101, 121, 82, 101, 112, 36, 84, 121, 112, 101, 59, 120, 112, 116, 0, 3, 82, 83, 65, 117, 114, 0, 2, 91, 66, -84, -13, 23, -8, 6, 8, 84, -32, 2, 0, 0, 120, 112, 0, 0, 2, 124, 48, -126, 2, 120, 2, 1, 0, 48, 13, 6, 9, 42, -122, 72, -122, -9, 13, 1, 1, 1, 5, 0, 4, -126, 2, 98, 48, -126, 2, 94, 2, 1, 0, 2, -127, -127, 0, -57, -14, -90, 97, 110, -70, -98, -68, 33, 10, 14, 0, -120, 77, -125, -31, 114, 120, 108, 104, 105, -28, 123, 78, 42, 109, -50, 76, -70, -109, -1, 8, -43, -116, 15, 21, -94, -74, -61, 42, 72, 53, 17, -33, -79, 16, -74, 26, 28, -114, 123, 124, 116, -108, 15, -84, -90, 85, 75, 107, -51, 14, -41, 121, -20, 92, 77, 57, -121, -5, -40, 16, -31, -114, -43, -54, 106, 29, 69, -39, -88, 112, 31, -92, -27, 4, -34, -88, 122, -43, 16, 88, -33, 121, -107, -44, -74, -24, -81, -101, 76, -22, 105, -108, 111, -22, -64, 4, -65, -99, 91, 27, 89, -23, 113, 49, 79, 1, -107, -18, -39, 43, -26, -52, 51, 109, 100, -111, 2, 3, 1, 0, 1, 2, -127, -127, 0, -101, -50, -91, 2, 85, -93, -52, -33, -14, -85, 0, 32, 64, 22, -113, 71, 21, -55, 107, 72, -82, 3, -94, 102, 85, -65, -67, 59, -93, 68, -126, 62, -29, 17, 66, 11, -19, 0, -105, -14, -111, -45, -16, -6, -85, -30, -58, -44, 112, 30, 67, 113, -58, -14, 61, -120, -97, 16, -26, 53, -71, -45, -17, -23, -84, 83, -19, -5, -78, -54, -74, -37, 18, -119, -85, -13, 108, 62, 40, -18, -78, 4, 46, 48, 28, -46, -123, -63, 114, -44, 16, -7, -16, 11, 64, -45, -14, 23, -46, -63, 106, -98, -11, -35, -56, -65, -103, -36, 84, 35, -12, 54, -42, 50, 65, 22, -45, -82, -76, 96, -126, 54, -36, -27, 92, -69, 92, 1, 2, 65, 0, -19, -103, 72, -19, 27, 87, -51, -118, -127, 90, -16, -73, -29, 13, -52, -121, 46, -90, 8, -24, -59, -95, 66, 41, -126, 38, 37, 14, -104, -65, 85, 38, 109, -83, 44, -104, 124, -67, 13, 28, 2, 50, 94, 67, 24, -38, 118, -30, 78, -84, 126, 33, 85, -68, 50, -45, 72, -65, -41, 15, 54, -27, -20, -47, 2, 65, 0, -41, 110, -30, -115, -42, 126, -101, 106, -84, 70, 12, 127, 110, 36, -50, -64, 96, -113, 123, -101, 66, 43, 127, -10, -113, 57, -45, 82, -28, -86, 106, -13, -11, -80, -101, 108, 24, 126, -50, -94, 64, -91, -30, -15, 60, -8, 29, -85, -67, -124, -50, -112, 72, 124, 110, -60, 53, 42, -79, -108, -55, 18, -21, -63, 2, 64, 22, 122, 65, -29, -20, -118, 73, -17, -88, 125, 41, -8, -69, -118, 58, -89, 47, 74, -107, -35, 47, -107, 41, -27, 51, 98, -40, 110, -95, 20, -72, -63, -127, -18, -72, 33, 84, -21, -83, -87, -48, -85, 99, 47, -123, -46, 101, 28, -45, -60, -115, -54, 41, -118, 60, 100, -80, -91, 53, 123, 66, -2, 77, -127, 2, 65, 0, -102, 37, -120, 75, -82, -9, -122, 99, 12, -125, 78, -69, -5, 102, -80, -35, 43, -6, 94, -102, 87, -3, 98, 33, 92, -104, 38, -94, 64, 101, -60, 3, 109, -128, 1, -91, -107, -35, 94, 34, -16, -103, 1, -54, 85, 50, -65, -96, 60, 10, 3, -9, 111, 54, 65, -41, 120, -89, 100, -53, 46, 24, -80, -63, 2, 65, 0, -91, -128, 52, -112, 116, 49, 56, 107, -71, 69, 29, -14, 69, 120, -4, -100, -77, -124, -109, 20, -88, 91, 26, 94, -44, 92, 9, 54, -128, 91, -102, -80, -111, -120, 81, -23, -99, -69, -31, 64, 22, -86, 13, 35, -14, 41, -91, -56, -96, 66, -26, -38, -13, -84, 117, -50, -5, 106, 1, 44, -48, -93, -100, -112, 116, 0, 6, 80, 75, 67, 83, 35, 56, 126, 114, 0, 25, 106, 97, 118, 97, 46, 115, 101, 99, 117, 114, 105, 116, 121, 46, 75, 101, 121, 82, 101, 112, 36, 84, 121, 112, 101, 0, 0, 0, 0, 0, 0, 0, 0, 18, 0, 0, 120, 114, 0, 14, 106, 97, 118, 97, 46, 108, 97, 110, 103, 46, 69, 110, 117, 109, 0, 0, 0, 0, 0, 0, 0, 0, 18, 0, 0, 120, 112, 116, 0, 7, 80, 82, 73, 86, 65, 84, 69, 115, 113, 0, 126, 0, 4, 113, 0, 126, 0, 9, 117, 113, 0, 126, 0, 10, 0, 0, 0, -94, 48, -127, -97, 48, 13, 6, 9, 42, -122, 72, -122, -9, 13, 1, 1, 1, 5, 0, 3, -127, -115, 0, 48, -127, -119, 2, -127, -127, 0, -57, -14, -90, 97, 110, -70, -98, -68, 33, 10, 14, 0, -120, 77, -125, -31, 114, 120, 108, 104, 105, -28, 123, 78, 42, 109, -50, 76, -70, -109, -1, 8, -43, -116, 15, 21, -94, -74, -61, 42, 72, 53, 17, -33, -79, 16, -74, 26, 28, -114, 123, 124, 116, -108, 15, -84, -90, 85, 75, 107, -51, 14, -41, 121, -20, 92, 77, 57, -121, -5, -40, 16, -31, -114, -43, -54, 106, 29, 69, -39, -88, 112, 31, -92, -27, 4, -34, -88, 122, -43, 16, 88, -33, 121, -107, -44, -74, -24, -81, -101, 76, -22, 105, -108, 111, -22, -64, 4, -65, -99, 91, 27, 89, -23, 113, 49, 79, 1, -107, -18, -39, 43, -26, -52, 51, 109, 100, -111, 2, 3, 1, 0, 1, 116, 0, 5, 88, 46, 53, 48, 57, 126, 113, 0, 126, 0, 13, 116, 0, 6, 80, 85, 66, 76, 73, 67};
			ci.keyPair = (KeyPair)MCouponUtil.ByteToObject(CAKeyByte);
			ciArray.add(ci);
			
			//Issuer1
			ci = new CertificateIDPair();
			ci.ID = "Issuer1";
			byte[] IC1keyByte = {-84, -19, 0, 5, 115, 114, 0, 21, 106, 97, 118, 97, 46, 115, 101, 99, 117, 114, 105, 116, 121, 46, 75, 101, 121, 80, 97, 105, 114, -105, 3, 12, 58, -46, -51, 18, -109, 2, 0, 2, 76, 0, 10, 112, 114, 105, 118, 97, 116, 101, 75, 101, 121, 116, 0, 26, 76, 106, 97, 118, 97, 47, 115, 101, 99, 117, 114, 105, 116, 121, 47, 80, 114, 105, 118, 97, 116, 101, 75, 101, 121, 59, 76, 0, 9, 112, 117, 98, 108, 105, 99, 75, 101, 121, 116, 0, 25, 76, 106, 97, 118, 97, 47, 115, 101, 99, 117, 114, 105, 116, 121, 47, 80, 117, 98, 108, 105, 99, 75, 101, 121, 59, 120, 112, 115, 114, 0, 20, 106, 97, 118, 97, 46, 115, 101, 99, 117, 114, 105, 116, 121, 46, 75, 101, 121, 82, 101, 112, -67, -7, 79, -77, -120, -102, -91, 67, 2, 0, 4, 76, 0, 9, 97, 108, 103, 111, 114, 105, 116, 104, 109, 116, 0, 18, 76, 106, 97, 118, 97, 47, 108, 97, 110, 103, 47, 83, 116, 114, 105, 110, 103, 59, 91, 0, 7, 101, 110, 99, 111, 100, 101, 100, 116, 0, 2, 91, 66, 76, 0, 6, 102, 111, 114, 109, 97, 116, 113, 0, 126, 0, 5, 76, 0, 4, 116, 121, 112, 101, 116, 0, 27, 76, 106, 97, 118, 97, 47, 115, 101, 99, 117, 114, 105, 116, 121, 47, 75, 101, 121, 82, 101, 112, 36, 84, 121, 112, 101, 59, 120, 112, 116, 0, 3, 82, 83, 65, 117, 114, 0, 2, 91, 66, -84, -13, 23, -8, 6, 8, 84, -32, 2, 0, 0, 120, 112, 0, 0, 2, 122, 48, -126, 2, 118, 2, 1, 0, 48, 13, 6, 9, 42, -122, 72, -122, -9, 13, 1, 1, 1, 5, 0, 4, -126, 2, 96, 48, -126, 2, 92, 2, 1, 0, 2, -127, -127, 0, -106, -116, 5, -56, 76, 65, -54, -33, 123, 39, 9, -91, -91, -50, -17, 92, -78, -22, 0, -69, 69, -51, -33, 105, -79, -116, -39, 123, -17, -62, 6, 19, -39, -66, -116, -85, 57, 97, -24, 71, -128, -43, 114, -6, 126, 79, 12, -39, 71, 40, 23, -98, 64, 28, 14, 114, -23, 38, -78, 19, -35, 23, 125, -34, 17, -8, -65, -112, 114, 55, -70, 121, 42, 97, -97, -65, 35, -52, -110, -14, 83, -12, 6, -110, 13, 52, 13, -3, -101, 61, 11, -33, 34, 9, -22, 18, -108, -68, 59, 35, -53, -97, 104, 24, 4, -82, 9, 67, -119, 16, 106, -84, 92, 73, 59, -118, -128, -124, -106, 108, 127, 31, -106, 123, -76, -42, 82, -121, 2, 3, 1, 0, 1, 2, -127, -128, 31, -53, -1, 68, -88, -26, -108, -124, -45, 44, 17, -101, -115, 3, -62, 6, -96, 59, 80, 96, 61, -124, 24, 21, -24, -52, 72, -5, 38, 78, -94, -99, -6, -75, -122, 92, 123, -56, 52, 25, 54, 26, -33, 40, 13, 25, -127, 43, 59, 30, 58, -82, -49, -9, -99, 13, -92, 52, -22, 19, -53, -12, -76, 62, -86, 12, 122, -68, -127, -4, -119, 41, 81, -6, -1, 98, -18, -49, -73, -64, 40, -15, 3, -85, -63, -17, -9, -128, -72, 35, -23, 117, -28, -20, -100, 21, -32, -22, 66, 42, -102, -21, 124, 114, -30, -19, 40, -7, -5, -71, -113, 78, 83, -5, -24, -7, 47, 71, -89, -106, -25, -92, 122, 46, 123, 66, 40, -95, 2, 65, 0, -47, -52, 44, 17, -6, -77, 63, -33, -32, 40, -60, 82, 115, -127, -80, -34, -85, 13, 86, 106, -109, -115, 94, 0, -27, 34, -127, 115, -54, -38, 102, 119, -54, -40, -23, 84, 74, 3, 22, -49, -68, -72, 50, -44, -17, -122, -10, 76, 93, -90, -124, -12, -62, -82, 24, 103, 110, 55, -31, -71, -54, -77, 38, 31, 2, 65, 0, -73, -77, 117, -58, 16, 95, -118, -13, 86, 51, 91, -124, -80, -43, -41, 4, -10, 95, 0, 103, -31, 76, -114, 80, -120, -28, 63, -104, 41, -7, -45, 21, -81, 36, 121, 85, -16, -43, -97, -4, -33, 81, 99, 10, -26, -38, 37, 47, 18, 79, 44, -75, 7, -118, -119, -68, 35, 95, -68, -4, -1, 6, 54, -103, 2, 64, 13, 1, -86, 109, -58, -20, 27, -10, -90, 48, 0, -45, -41, -61, 95, -110, -66, 106, 10, 68, 123, 55, 85, 111, -102, -59, 3, -33, -120, -32, -9, 95, 79, -35, 24, -62, 24, 0, -113, 6, 123, -3, -77, 113, 14, 20, -128, -22, -123, 23, -48, -64, 87, -35, 113, 55, -32, 86, 104, -111, 27, 38, -10, 35, 2, 65, 0, -76, -75, 24, 21, 23, -60, 52, -10, -3, 4, 22, 114, 40, 86, -93, 103, 33, 73, 1, 40, 47, 44, 85, 15, 10, 42, -90, 24, 116, -86, 106, 40, 121, -101, 2, -75, 52, -19, -96, -83, 107, -83, 47, 37, -23, 68, 12, -78, 10, 107, -46, 73, -34, -70, 60, -107, -45, -94, 121, 81, -45, 57, 116, 121, 2, 64, 106, 126, -80, -120, -107, -51, -99, 34, -89, -34, -52, -55, -20, 34, -11, 89, -18, 60, 39, 17, -90, 9, 54, -53, 9, 29, -14, 94, -14, 39, -28, -18, 107, 80, -80, -65, 67, 10, -16, -56, 59, 16, -118, -83, -38, -102, 63, 51, -9, -113, -54, 34, 38, -90, 43, -6, 109, -120, 57, 64, -64, -68, 44, -33, 116, 0, 6, 80, 75, 67, 83, 35, 56, 126, 114, 0, 25, 106, 97, 118, 97, 46, 115, 101, 99, 117, 114, 105, 116, 121, 46, 75, 101, 121, 82, 101, 112, 36, 84, 121, 112, 101, 0, 0, 0, 0, 0, 0, 0, 0, 18, 0, 0, 120, 114, 0, 14, 106, 97, 118, 97, 46, 108, 97, 110, 103, 46, 69, 110, 117, 109, 0, 0, 0, 0, 0, 0, 0, 0, 18, 0, 0, 120, 112, 116, 0, 7, 80, 82, 73, 86, 65, 84, 69, 115, 113, 0, 126, 0, 4, 113, 0, 126, 0, 9, 117, 113, 0, 126, 0, 10, 0, 0, 0, -94, 48, -127, -97, 48, 13, 6, 9, 42, -122, 72, -122, -9, 13, 1, 1, 1, 5, 0, 3, -127, -115, 0, 48, -127, -119, 2, -127, -127, 0, -106, -116, 5, -56, 76, 65, -54, -33, 123, 39, 9, -91, -91, -50, -17, 92, -78, -22, 0, -69, 69, -51, -33, 105, -79, -116, -39, 123, -17, -62, 6, 19, -39, -66, -116, -85, 57, 97, -24, 71, -128, -43, 114, -6, 126, 79, 12, -39, 71, 40, 23, -98, 64, 28, 14, 114, -23, 38, -78, 19, -35, 23, 125, -34, 17, -8, -65, -112, 114, 55, -70, 121, 42, 97, -97, -65, 35, -52, -110, -14, 83, -12, 6, -110, 13, 52, 13, -3, -101, 61, 11, -33, 34, 9, -22, 18, -108, -68, 59, 35, -53, -97, 104, 24, 4, -82, 9, 67, -119, 16, 106, -84, 92, 73, 59, -118, -128, -124, -106, 108, 127, 31, -106, 123, -76, -42, 82, -121, 2, 3, 1, 0, 1, 116, 0, 5, 88, 46, 53, 48, 57, 126, 113, 0, 126, 0, 13, 116, 0, 6, 80, 85, 66, 76, 73, 67};
			ci.keyPair = (KeyPair)MCouponUtil.ByteToObject(IC1keyByte);
			ciArray.add(ci);
			
			//Issuer2
			ci = new CertificateIDPair();
			ci.ID = "Issuer2";
			byte[] IC2keyByte = {-84, -19, 0, 5, 115, 114, 0, 21, 106, 97, 118, 97, 46, 115, 101, 99, 117, 114, 105, 116, 121, 46, 75, 101, 121, 80, 97, 105, 114, -105, 3, 12, 58, -46, -51, 18, -109, 2, 0, 2, 76, 0, 10, 112, 114, 105, 118, 97, 116, 101, 75, 101, 121, 116, 0, 26, 76, 106, 97, 118, 97, 47, 115, 101, 99, 117, 114, 105, 116, 121, 47, 80, 114, 105, 118, 97, 116, 101, 75, 101, 121, 59, 76, 0, 9, 112, 117, 98, 108, 105, 99, 75, 101, 121, 116, 0, 25, 76, 106, 97, 118, 97, 47, 115, 101, 99, 117, 114, 105, 116, 121, 47, 80, 117, 98, 108, 105, 99, 75, 101, 121, 59, 120, 112, 115, 114, 0, 20, 106, 97, 118, 97, 46, 115, 101, 99, 117, 114, 105, 116, 121, 46, 75, 101, 121, 82, 101, 112, -67, -7, 79, -77, -120, -102, -91, 67, 2, 0, 4, 76, 0, 9, 97, 108, 103, 111, 114, 105, 116, 104, 109, 116, 0, 18, 76, 106, 97, 118, 97, 47, 108, 97, 110, 103, 47, 83, 116, 114, 105, 110, 103, 59, 91, 0, 7, 101, 110, 99, 111, 100, 101, 100, 116, 0, 2, 91, 66, 76, 0, 6, 102, 111, 114, 109, 97, 116, 113, 0, 126, 0, 5, 76, 0, 4, 116, 121, 112, 101, 116, 0, 27, 76, 106, 97, 118, 97, 47, 115, 101, 99, 117, 114, 105, 116, 121, 47, 75, 101, 121, 82, 101, 112, 36, 84, 121, 112, 101, 59, 120, 112, 116, 0, 3, 82, 83, 65, 117, 114, 0, 2, 91, 66, -84, -13, 23, -8, 6, 8, 84, -32, 2, 0, 0, 120, 112, 0, 0, 2, 124, 48, -126, 2, 120, 2, 1, 0, 48, 13, 6, 9, 42, -122, 72, -122, -9, 13, 1, 1, 1, 5, 0, 4, -126, 2, 98, 48, -126, 2, 94, 2, 1, 0, 2, -127, -127, 0, -109, 34, -2, 114, -50, -68, 36, -49, -42, -60, 115, 1, 94, 76, 120, -38, 111, 79, -52, 48, 26, -18, -112, -97, -71, 70, 58, -58, 51, -33, 43, -117, 83, 30, 105, -3, 23, 31, -12, -46, -15, -98, 20, 52, 120, 33, -119, 39, 87, -4, -6, 84, -50, 84, -123, 106, 56, -100, -45, 78, -19, 48, 108, 51, 127, -46, -90, 39, -57, 113, 104, 10, 125, -52, 89, 19, -115, -67, 120, -5, -22, 103, -32, 80, -14, -100, 83, -23, 49, -50, -55, -94, -5, 39, -119, 108, 0, -82, -81, -127, 90, -37, 64, -19, 84, 36, 0, 127, 98, 42, 123, -87, 92, 77, 99, -89, 88, -58, 124, -75, 102, 63, -19, -103, 83, 74, -95, -87, 2, 3, 1, 0, 1, 2, -127, -128, 18, -10, -36, -78, -15, -128, -128, -126, 37, 93, 86, -79, 99, 117, 25, -46, -107, -84, 68, 86, 34, -14, -126, -61, -125, 126, -48, -50, -127, 27, 15, -94, -70, -120, -34, 2, 87, -5, -81, 115, -116, -34, -30, 29, -51, 42, 13, 98, 123, -51, -56, 122, 43, -55, -21, 20, 64, -51, -67, -46, -101, 113, -75, 80, 79, -25, 119, -67, 123, -26, 59, 11, -87, 27, 117, -87, -13, 75, 15, -83, -23, 98, -4, 28, 2, -90, -13, 66, 24, 32, 46, 53, 119, -100, 9, 30, -128, -77, 56, 118, 85, 0, -76, -7, -92, 86, -77, 38, 14, 126, 71, 23, -47, 68, 106, -45, -44, 2, -3, -10, 101, 66, -30, 88, 80, -14, -58, 45, 2, 65, 0, -56, -88, -7, 119, -125, -50, 62, 93, -70, -90, -80, -73, -105, -48, -124, -33, 54, -23, 121, -103, -98, 108, -70, -42, 4, -118, -26, -117, 19, -128, 120, 85, 110, -77, 77, -11, -23, 0, 9, -51, 8, 39, -73, -31, 26, 9, -38, -17, 74, 65, -62, 17, -87, 66, -5, -4, -105, 92, -31, 60, 10, -80, -71, 111, 2, 65, 0, -69, -73, 40, 25, 58, 25, 115, -127, 76, 71, -23, 59, -73, 56, -118, 2, 108, 94, 4, -53, -85, -4, 66, -31, -84, -86, 119, 0, 22, -30, -88, 100, -115, -3, 104, 26, -64, 42, -36, -98, -71, -4, -9, 72, 95, -109, 27, -60, -47, -125, -7, -44, -124, 30, -69, -19, -26, 8, 94, 32, 37, 113, 90, 103, 2, 65, 0, -59, 77, 32, -66, 91, 99, -105, -1, 33, 96, 117, -78, -112, 28, 0, 10, 91, 60, 6, -52, -3, -15, 123, 100, -92, -30, -50, -3, 65, 23, -71, 58, -121, -74, -42, -103, 77, -103, 52, 9, -34, 82, -17, -126, -18, -49, 113, -18, -121, -35, 80, -83, 124, -8, -40, 60, -19, -73, -19, -33, -45, -61, 33, 17, 2, 65, 0, -113, -62, -86, -85, -1, 73, -28, -94, -34, 87, -88, 112, -70, 86, 75, -93, -91, 120, -81, -75, -121, -26, -81, 22, 4, 85, -100, -61, 109, -61, 114, 113, 104, 40, -19, 100, -89, 77, 108, 31, 7, -109, -117, -110, 90, -41, -32, 9, 112, -25, -31, 26, 119, -128, -50, 46, 88, -32, -119, -83, -106, -33, 99, -5, 2, 65, 0, -119, -94, 17, -39, -1, -97, 127, -82, -114, 18, -128, -118, 56, 116, 28, 58, -115, 48, -111, -125, -6, 35, 18, -9, 28, -96, -18, 72, 124, -85, -62, 36, -109, 97, 121, 44, 36, 24, -15, 69, 123, 54, 105, 121, -91, -22, 27, 32, 26, 13, -98, 100, 22, -51, -63, 15, 90, 91, -28, 71, -83, -15, 78, -43, 116, 0, 6, 80, 75, 67, 83, 35, 56, 126, 114, 0, 25, 106, 97, 118, 97, 46, 115, 101, 99, 117, 114, 105, 116, 121, 46, 75, 101, 121, 82, 101, 112, 36, 84, 121, 112, 101, 0, 0, 0, 0, 0, 0, 0, 0, 18, 0, 0, 120, 114, 0, 14, 106, 97, 118, 97, 46, 108, 97, 110, 103, 46, 69, 110, 117, 109, 0, 0, 0, 0, 0, 0, 0, 0, 18, 0, 0, 120, 112, 116, 0, 7, 80, 82, 73, 86, 65, 84, 69, 115, 113, 0, 126, 0, 4, 113, 0, 126, 0, 9, 117, 113, 0, 126, 0, 10, 0, 0, 0, -94, 48, -127, -97, 48, 13, 6, 9, 42, -122, 72, -122, -9, 13, 1, 1, 1, 5, 0, 3, -127, -115, 0, 48, -127, -119, 2, -127, -127, 0, -109, 34, -2, 114, -50, -68, 36, -49, -42, -60, 115, 1, 94, 76, 120, -38, 111, 79, -52, 48, 26, -18, -112, -97, -71, 70, 58, -58, 51, -33, 43, -117, 83, 30, 105, -3, 23, 31, -12, -46, -15, -98, 20, 52, 120, 33, -119, 39, 87, -4, -6, 84, -50, 84, -123, 106, 56, -100, -45, 78, -19, 48, 108, 51, 127, -46, -90, 39, -57, 113, 104, 10, 125, -52, 89, 19, -115, -67, 120, -5, -22, 103, -32, 80, -14, -100, 83, -23, 49, -50, -55, -94, -5, 39, -119, 108, 0, -82, -81, -127, 90, -37, 64, -19, 84, 36, 0, 127, 98, 42, 123, -87, 92, 77, 99, -89, 88, -58, 124, -75, 102, 63, -19, -103, 83, 74, -95, -87, 2, 3, 1, 0, 1, 116, 0, 5, 88, 46, 53, 48, 57, 126, 113, 0, 126, 0, 13, 116, 0, 6, 80, 85, 66, 76, 73, 67};
			ci.keyPair = (KeyPair)MCouponUtil.ByteToObject(IC2keyByte);
			ciArray.add(ci);
			
			//User
			ci = new CertificateIDPair();
			ci.ID = "User";
			byte[] UserkeyByte = {-84, -19, 0, 5, 115, 114, 0, 21, 106, 97, 118, 97, 46, 115, 101, 99, 117, 114, 105, 116, 121, 46, 75, 101, 121, 80, 97, 105, 114, -105, 3, 12, 58, -46, -51, 18, -109, 2, 0, 2, 76, 0, 10, 112, 114, 105, 118, 97, 116, 101, 75, 101, 121, 116, 0, 26, 76, 106, 97, 118, 97, 47, 115, 101, 99, 117, 114, 105, 116, 121, 47, 80, 114, 105, 118, 97, 116, 101, 75, 101, 121, 59, 76, 0, 9, 112, 117, 98, 108, 105, 99, 75, 101, 121, 116, 0, 25, 76, 106, 97, 118, 97, 47, 115, 101, 99, 117, 114, 105, 116, 121, 47, 80, 117, 98, 108, 105, 99, 75, 101, 121, 59, 120, 112, 115, 114, 0, 20, 106, 97, 118, 97, 46, 115, 101, 99, 117, 114, 105, 116, 121, 46, 75, 101, 121, 82, 101, 112, -67, -7, 79, -77, -120, -102, -91, 67, 2, 0, 4, 76, 0, 9, 97, 108, 103, 111, 114, 105, 116, 104, 109, 116, 0, 18, 76, 106, 97, 118, 97, 47, 108, 97, 110, 103, 47, 83, 116, 114, 105, 110, 103, 59, 91, 0, 7, 101, 110, 99, 111, 100, 101, 100, 116, 0, 2, 91, 66, 76, 0, 6, 102, 111, 114, 109, 97, 116, 113, 0, 126, 0, 5, 76, 0, 4, 116, 121, 112, 101, 116, 0, 27, 76, 106, 97, 118, 97, 47, 115, 101, 99, 117, 114, 105, 116, 121, 47, 75, 101, 121, 82, 101, 112, 36, 84, 121, 112, 101, 59, 120, 112, 116, 0, 3, 82, 83, 65, 117, 114, 0, 2, 91, 66, -84, -13, 23, -8, 6, 8, 84, -32, 2, 0, 0, 120, 112, 0, 0, 2, 123, 48, -126, 2, 119, 2, 1, 0, 48, 13, 6, 9, 42, -122, 72, -122, -9, 13, 1, 1, 1, 5, 0, 4, -126, 2, 97, 48, -126, 2, 93, 2, 1, 0, 2, -127, -127, 0, -94, -45, 53, 115, 60, 100, -5, -85, -75, -68, 17, 109, -64, 99, -50, -104, 35, -84, -96, 2, 111, -9, -25, -31, -119, 3, 21, 31, 76, -90, -77, 5, 73, -30, 52, -17, 96, 46, 11, -88, 97, 1, -30, -21, 52, 98, 23, 104, 13, 87, 80, -24, -15, 117, -27, 82, 111, -94, -125, -70, -29, -4, 110, 120, 126, -64, 18, -121, 64, -85, 96, 103, -67, 45, 65, -29, -11, 120, -2, 64, 56, -16, -67, 91, -91, -9, -103, 53, 123, -81, 75, -95, -32, 26, -91, -11, 68, 82, 67, 106, -31, -27, -81, -66, -49, 48, 11, -64, 103, -99, -85, -36, -46, 86, -94, 12, -119, -15, -116, -51, -122, -48, -11, -96, -74, 82, -126, -109, 2, 3, 1, 0, 1, 2, -127, -128, 75, 98, -20, -95, 96, -6, 4, 71, -39, 9, -83, 44, 26, 98, 91, 121, -73, 50, -86, -106, -42, 78, 122, 78, -62, -57, -23, -108, -89, 65, -101, 43, 60, -84, -2, 3, 66, -115, -81, 26, 19, 103, -13, 47, 32, -2, -75, -123, -104, 127, -81, -41, 90, 76, 82, -109, -101, 90, 44, 17, 112, -109, 36, 117, -24, -63, 81, 92, -123, -82, -2, -124, -65, -49, 107, 102, -25, 82, 9, -36, 13, -114, 114, -100, 124, -80, -96, -7, -79, -109, 99, 92, -116, -100, 112, 99, 33, -38, -75, -106, 106, -52, 6, -17, -1, -122, -101, 38, 4, -2, -68, 75, 98, 83, -107, -6, 59, 125, 41, -99, 96, -25, 106, -57, -47, -97, -73, 57, 2, 65, 0, -23, 101, -102, 0, -32, 87, -102, -80, -36, 18, 52, -37, -105, -91, -115, -9, -113, 37, -104, -65, 39, -39, 116, 62, -98, 85, 12, 81, -107, -119, -27, -49, -51, 15, 96, 59, -15, -73, -85, 98, -38, -83, 81, 36, -124, 90, 17, 10, -63, -64, -51, -16, 99, 94, 7, 21, -114, -89, -83, 84, -27, -12, -86, -17, 2, 65, 0, -78, -105, -5, -87, 26, 32, -53, -121, -112, 4, 120, -40, 64, -36, -43, -12, -80, 4, 5, -30, 127, -48, 5, -109, -111, 3, -40, -119, 68, 4, -67, -98, 112, -84, 101, 45, 119, -119, -124, 99, 117, -60, 81, -26, -18, -71, 50, 8, -102, -102, -77, -41, 40, -112, 100, 49, -62, 122, -86, -55, 68, 77, 50, -99, 2, 65, 0, -45, 108, 117, 56, 76, 1, 47, -96, -4, -118, 5, -107, -46, 102, 103, 23, 21, 118, 2, 75, 79, 38, -35, -11, -121, 106, 21, 113, -90, 27, -73, -79, 40, -39, -65, -36, 45, 87, -85, 10, 46, 123, -120, 32, -93, 64, 15, 102, 6, 35, -56, -87, -12, -23, -115, 83, 74, -39, -69, -37, 71, 63, -2, -61, 2, 65, 0, -126, 76, 12, 25, 117, -84, -109, -111, 85, -21, 77, 87, 73, 11, 85, 53, -19, -19, 33, 117, -4, -106, 2, 91, -123, 35, 111, 41, -58, 108, 71, 3, 127, 100, -25, 116, 98, -113, -5, -4, -84, -127, 12, -40, 21, 55, 28, 95, -42, -100, 35, -75, 72, 45, 0, 76, -91, 124, -27, 121, 109, -47, 124, -87, 2, 64, 72, -48, -52, 45, -58, 75, -89, 54, -94, 88, -21, 21, 94, 67, -57, 92, -19, -121, -120, -82, 65, 41, -46, 5, 67, 58, -49, -89, -97, 48, 103, 95, 67, -40, -41, -63, 30, -24, -53, -119, -99, 27, 48, -51, -125, -28, -118, 112, -73, 71, 107, -85, -29, 48, 31, 17, -16, 104, 8, -79, -102, -86, -47, 85, 116, 0, 6, 80, 75, 67, 83, 35, 56, 126, 114, 0, 25, 106, 97, 118, 97, 46, 115, 101, 99, 117, 114, 105, 116, 121, 46, 75, 101, 121, 82, 101, 112, 36, 84, 121, 112, 101, 0, 0, 0, 0, 0, 0, 0, 0, 18, 0, 0, 120, 114, 0, 14, 106, 97, 118, 97, 46, 108, 97, 110, 103, 46, 69, 110, 117, 109, 0, 0, 0, 0, 0, 0, 0, 0, 18, 0, 0, 120, 112, 116, 0, 7, 80, 82, 73, 86, 65, 84, 69, 115, 113, 0, 126, 0, 4, 113, 0, 126, 0, 9, 117, 113, 0, 126, 0, 10, 0, 0, 0, -94, 48, -127, -97, 48, 13, 6, 9, 42, -122, 72, -122, -9, 13, 1, 1, 1, 5, 0, 3, -127, -115, 0, 48, -127, -119, 2, -127, -127, 0, -94, -45, 53, 115, 60, 100, -5, -85, -75, -68, 17, 109, -64, 99, -50, -104, 35, -84, -96, 2, 111, -9, -25, -31, -119, 3, 21, 31, 76, -90, -77, 5, 73, -30, 52, -17, 96, 46, 11, -88, 97, 1, -30, -21, 52, 98, 23, 104, 13, 87, 80, -24, -15, 117, -27, 82, 111, -94, -125, -70, -29, -4, 110, 120, 126, -64, 18, -121, 64, -85, 96, 103, -67, 45, 65, -29, -11, 120, -2, 64, 56, -16, -67, 91, -91, -9, -103, 53, 123, -81, 75, -95, -32, 26, -91, -11, 68, 82, 67, 106, -31, -27, -81, -66, -49, 48, 11, -64, 103, -99, -85, -36, -46, 86, -94, 12, -119, -15, -116, -51, -122, -48, -11, -96, -74, 82, -126, -109, 2, 3, 1, 0, 1, 116, 0, 5, 88, 46, 53, 48, 57, 126, 113, 0, 126, 0, 13, 116, 0, 6, 80, 85, 66, 76, 73, 67};
			ci.keyPair = (KeyPair)MCouponUtil.ByteToObject(UserkeyByte);
			ciArray.add(ci);
		}
	}
	
	public CertificateIDPair getKey(String ID)
	{
		CertificateIDPair ci = null;
		
		for(int i = 0; i < ciArray.size(); i++)
		{
			if(ciArray.get(i).ID.compareTo(ID) == 0)
			{
				ci = ciArray.get(i);
			}
		}
		
		return ci;
	}
	
	//ID와 Key를 생성
	public CertificateIDPair generateKeyIdPair()
	{
		CertificateIDPair cip = new CertificateIDPair();
		
		SecureRandom random = null;
		KeyPairGenerator keyGen = null;
		
		cip.ID = UUID.randomUUID().toString();
		
		try {
			keyGen = KeyPairGenerator.getInstance("RSA");
			random = SecureRandom.getInstance("SHA1PRNG");
		} catch (NoSuchAlgorithmException e) {
			e.printStackTrace();
		}
		
		keyGen.initialize(1024, random);
		cip.keyPair = keyGen.generateKeyPair();
		
		return cip;
	}
	
	//ni, nc등 Random Number를 생성
	public static byte[] getRandomNumber()
	{
		SecureRandom random = null;
		byte[] RandomNumber = new byte[20];
		
		try {
			random = SecureRandom.getInstance("SHA1PRNG");
		} catch (NoSuchAlgorithmException e) {
			// TODO Auto-generated catch block
			e.printStackTrace();
		}
		
		random.nextBytes(RandomNumber);
		
		return RandomNumber;
	}
	
}